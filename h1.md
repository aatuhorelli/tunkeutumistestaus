# Hacker Warmup 

Tehtävänannot luettavissa osoitteessa https://terokarvinen.com/2024/eettinen-hakkerointi-2024/

Raportissa käytetty laite Asus Vivobook X1505. Järjestelmän olennaiset tiedot:
````
OS: Debian 12 (Bookworm)
RAM: 16GB
CPU: 12th Gen Intel(R) Core(TM) i7-1255u (x86_64)
````


## X) Lue ja tiivistä

### Surveying essential tools for active recoinnassance | The art of hacking video collection

#### Understanding Active Recoinnassance
- Passiivisessa tiedustelussa ei aktiivisesti lähetetä paketteja kohdejärjestelmään
  - Ei näy lokeissa
- Aktiivisessa tiedustelussa järjestelmiin lähetetään paketteja esim. tekemällä portti- tai haavoittuvuusskannauksia
  - Toiminnot nähtävissä lokeista
- Skannauksia vähitellen lisäämällä pääteltävissä, aiheuttaako tiedustelu toimenpiteitä tai hälytyksiä hyökkäyksen kohteena olevassa järjestelmässä

#### Exploring Active Recoinnassance Methodologies from an Ethical Hacker Perspective
- Järjestelmällisyys tutkinnassa on tärkeää
  - Rajallinen aikataulu
  - Kohteiden ja haavoittuvuuksien valinta
- Tiedustelun jälkeen tulisi olla hyvä kuva siitä, mihin järjestelmiin ja palveluihin hyökkäyksensä kohdistaa
- Kolme testiä:
  - Porttiskannaukset: varmistetaan passiivisessa tiedustelussa havaittujen avointen porttien lisäksi muut avoimet portit porttiskannereita käyttäen
  - Web Service Review: tutkitaan, mitä web-applikaatioita järjestelmässä on käytössä ja valitaan, mihin niistä hyökkäys kohdistetaan
  - Haavoittuvuusskannaus: tiedustelun viimeinen ja tärkeä vaihe. Aiheuttaa todennäköisimmin hälytyksiä kohdejärjestelmässä. Ei kannata tehdä ennen muita testejä.
 
#### Port Scanning and Web Service Review
- Porttiskannereita:
  - Nmap (https://nmap.org): monipuolisin porttiskanneri. Vakaa. Porttiskannaukset, palvelu- ja käyttöjärjestelmätunnistus, haavoittuvuusskannaukset.
    - Käyttö: ``$ nmap [asetukset] [kohde]``, esim. ``$ nmap -sS -vv -T4 -A ip-osoite``.
      - ``-sS``: TCP-send skannaus (half-open connection). Palvelimen avoimien porttien ilmoituksiin ei lähetetä vastauksia.
      - ``-vv``: Verbose, tulostaa skannauksen tietoja
      - ``-T4``: Nopeuttaa skannsusta
      - ``-A``: Lisäominaisuuksia: skriptejä, käyttöjärjestelmän ja versioiden tunnistus
      - ``-Pn``: Suositeltava käytettäväksi internetistä skannatessa. Ilman tätä asetusta skannaukset jäävät suurelta osin palomuuriin.
      - ``-p1-65535``: skannattavien porttien valinta. Tietty portti tai useita portteja.
  - Masscan (https://github.com/robertdavidgraham/masscan.git): Nopein porttiskanneri. Mahdollistaa tietyn portin skannaamisen koko Internetistä. Ei yhtä monipuolinen kuin nmap, mutta nopeampi suurien verkkojen skannaamiseen.
    - Käyttö:
      - ``$ masscan [asetukset] [kohde] --rate=[pakettien määrä/s]``. Esim ``$ masscan -p80,443 192.168.1.0/24 --rate=10000``
        - ``-p80,443``: skannattavat portit
        - ``192.168.1.0/24``: skannattavan verkon osoite
        - ``--rate=10000``: pakettien määrä/s
  - Udpprotoscanner(https://github.com/portcullislabs/udp-proto-scanner.git): UDP-porttiskanneri. Yleensä porttiskannerit keskittyvät TCP-protokollaan, mutta Udpprotoscannerilla voi skannata verkon UDP-portit nopeasti.
    - Käyttö:
      - ``$ ./udp-proto-scanner.pl [verkon ip-osoite]`` - Skannaa verkon avoimet UDP-portit

- Web Service Review -työkaluja:
  - EyeWitness(https://github.com/ChrisTruncer/EyeWitness): Suositeltu työkalu. Etsii verkosta kaikki web-sivut kuvankaappauksineen ja lisätiedoilla.
    - Käyttö:
      - Ensin porttiskannaus esim. nmapilla (http/https-portit)
      - ``$ ./EyeWitness.py --web -f ip_list.txt``
        - ``--web``: skannataan järjestelmiä porteista 80 ja 443
        - ``-f ip_list.txt``: kohdeosoitteet tiedostosta
       
#### Network and Web Vulnerability Scanners
- Verkon haavoittuvuusskannaukseen:
  - OpenVAS (open source)
  - Nessus
  - Nexpose
  - Qualys
  - Nmap (rajalliset ominaisuudet, pääosin porttiskanneri)
    - Esimerkkikäyttö: ``$ nmap -SC smb-vuln-ms17-010 192.168.1.2``
      - ``-SC``: Script scan + skriptin nimi. Skriptit löytyvät /usr/share/nmap/-hakemistosta. Listattu myös (https://nmap.org/nsedoc/scripts/)
 
- Web-haavoittuvuusskannerit:
  - Nikto: Helppokäyttöinen, yleinen
  - WPScan: WordPress-pohjaisille sivuille
  - SQLMap: Tietokannat, SQL-injektiot
  - Burp Suite: Web-applikaatioiden suosituimpia skannereita. Toimii myös proxynä.
  - Zed Attack Proxy (OWASP ZAP): Ilmainen, vastaava kuin Burp Suite.
  

Lähde: [Surveying Essential Tools for Active Recoinnassance](https://learning.oreilly.com/videos/the-art-of/9780135767849/9780135767849-SPTT_04_00). Katsottu 30.3.2024.

### Hutchins et al 2011: Intelligence-Driven Computer Network Defense Informed by Analysis of Adversary Campaigns and Intrusion Kill Chains
 
 - APT: Advanced Persistent Threat. Tiettyjen alojen suurin tietoturvauhka, jonka tarkoituksena on hyötyä varastetusta datasta taloudellisesti tai sotilaallisesti. 


Lähde: [https://lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-Paper-Intel-Driven-Defense.pdf](https://lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-Paper-Intel-Driven-Defense.pdf). Luettu 5.4.2024

## A) Over the Wire: Bandit

[Over the Wire](https://overthewire.org/wargames/) on sivusto, jonka kautta voi pelillisesti harjoitella tietoturvan eri osa-alueita. Bandit on peleistä helpoin ja se on suunnattu vasta-alkajille.

### Level 0
Tason tehtävänä on ottaa SSH-yhteys bandit.labs.overthewire.org-palveluun portista 2220. Käyttäjätunnus ja salasana ovat bandit0:bandit0.

Aloitin tehtävän avaamalla terminaalin. Otin yhteyden palvelimeen komennolla ``$ ssh bandit0@bandit.labs.overthewire.org -p 2220``. ``ssh``-komentoa käytetään salatun SSH-yhteyden muodostamiseen, bandit0@bandit.labs.overthewire.org on palvelimen osoite ja käytettävä käyttäjätunnus, ja käytettävä portti määritetään ``-p 2220``-asetuksella. Annoin salasanaksi palvelimen sitä kysyessä bandit0, minkä jälkeen pääsin sisälle. Tehtävä ratkaistu!

### Level 1
Tason tehtävänä oli etsiä seuraavan tason salasana kotihakemistossa sijaitsevasta tiedostosta readme, ja käyttää tätä seuraavalle tasolle kirjautuessa.

Listasin hakemiston tiedostot komennolla ``$ ls``. minkä jälkeen tulostin hakemistosta löytyvän readme-tiedoston sisällön komennolla ``$ cat readme``. Kopioin tiedostossa olevan salasanan maalaamalla sen kursorilla, minkä jälkeen kirjauduin ulos palvelimelta komennolla ``$ logout`` voidakseni muodostaa seuraavalle tasolle SSH-yhteyden komennolla ``$ ssh bandit1@bandit.labs.overthewire.org -p 2220``. Salasanaa kysyttäessä annoin kopioimani salasanan klikkaamalla terminaalin ikkunaa hiiren oikealla painikkeella. Kirjautuminen onnistui, ja taso oli suoritettu!

### Level 2
Tason tehtävänä oli lukea salasana tiedostosta '-'. 

Otin edellisen tehtävän tapaan yhteyden palvelimelle tunnuksella bandit2. Tiedosto löytyi kotihakemistosta komennolla ``$ ls``. Komentorivin komennoille annetaan usein lisäargumentteja käyttämällä etuliitteenä merkkiä '-', joten tiedostoa ei voi avata suoraan komennolla ``$ cat -``. Ajattelin vaihtoehtoisia tapoja olevan tulostaa koko hakemiston kaikki tiedostot (``$ cat ./*``), tai käyttää '-merkkejä tiedostonimen ympärillä ``$ cat '-'``. Ensimmäinen yritys toimi, toinen ei. Painoin päällimmäisen prosessin tappavaa pikakomentoa ctrl+c, ja koitin uutta lähestymistapaa. Muokkasin jälkimmäistä komentoa käyttämään tiedoston koko polkua komennolla ``$ cat ./-``. "." on pikakomento nykyiselle hakemistolle. Salasana tulostui ja oli käytettävissä seuraavalle tasoille siirtymiseen. 

### Level 3
Tason tehtävänä oli lukea salasana tiedostosta 'spaces in this filename'.

Katkaisin ensin edellisen tehtävän ssh-yhteyden komennolla ``$ logout``, minkä jälkeen otin yhteyden seuraavalle tasolle tunnuksella bandit2 ja annoin edellisestä tehtävästä löytämäni salasanan palvelimen sitä kysyessä. Edellisen tehtävän ratkaisu ``$ cat ./*`` toimi suoraa tässäkin, ja myös toinen lähestymistapa tiedoston nimeä käyttämällä toimi siten, että käytin TAB-näppäintä täydentämään tiedoston nimen. Tämä lisäsi automaattisesti välilyöntien väleihin escapeina käytettävät \\-merkit, ja tiedoston sisältö tulostui.

## B) WebGoat

## C) PortSwigger


## Lähteet

[Terokarvinen.com - Tunkeutumistestaus 2024](https://terokarvinen.com/2024/eettinen-hakkerointi-2024/). Luettu 30.3.

[Surveying Essential Tools for Active Recoinnassance](https://learning.oreilly.com/videos/the-art-of/9780135767849/9780135767849-SPTT_04_00). Katsottu 30.3.
